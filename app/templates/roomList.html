{% extends 'base.html' %}

{% block statics %}
{{ super() }}
<!-- Scripts and CSS for DatePicker -->
<script type="text/javascript" src="https://cdn.jsdelivr.net/jquery/latest/jquery.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css" />

<link rel="stylesheet" href="{{ url_for('static', filename='css/roomList.css') }}">
{% endblock %}

{% block body %}
<script>
    $(document).ready(() => {
        $(function () {
            $('input[name="daterange"]').daterangepicker({
                opens: 'center',
                autoApply: true,
            });
        });

        $('#room-search-form').submit(function (e) {
            e.preventDefault();
            const url = $(this).attr('action');
            const formData = new FormData(this);
            const dateRangePicker = $('input[name="daterange"]').data('daterangepicker');
            const csrf_token = "{{ csrf_token() }}";

            $.ajax({
                url: url,
                data: {
                    csrf_token: csrf_token,
                    check_in_date: dateRangePicker.startDate.format('YYYY-MM-DD'),
                    check_out_date: dateRangePicker.endDate.format('YYYY-MM-DD'),
                    num_occupants: formData.get('numOccupants'),
                    room_type: formData.get('roomtype')
                },

            }).done(data => {
                $('#room-search-results-main').html(data)
            })
        })
    })
</script>

<div id="home-main-div">
    <div id="home-viewport1" class="flex-viewport-div">
        <h1 id="hotel-callisto-title">Hotel Callisto</h1>
        <div id="room-search-form-container">
            <div class="calendar-container">
                <form id="room-search-form" action="{{ url_for('fetch_room_list') }}">
                    <div id="room-search-param-container">
                        <input type="text" name="daterange" value="" class="room-search-params" />
                        <select name="numOccupants" class="room-search-params" placeholder="Guests">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                        </select>
                        <select name="roomtype" class="room-search-params">
                            <option value="Regular">Regular</option>
                            <option value="Executive">Executive</option>
                            <option value="President">President</option>
                        </select>
                        <button type="submit" class="room-search-params" id="room-search-param-submit">Submit</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
    <div id="room-search-results-main">

    </div>
</div>

{% endblock %}